---
name: Go DAG Execution Engine
description: Traversing an asynchronous React Flow DAG systematically in Go.
---
# Go DAG Engine

## Key Findings & Caveats
1. **Data Structures:** The `nodes` and `edges` exported by React Flow are JSON Arrays. Best practice is to save them as `JSONB` in the Postgres DB, then unmarshal them sequentially into specific `ReactFlowNode` and `ReactFlowEdge` structs in Go at runtime.
2. **Finding the Trigger Node**: Graphs generated by React Flow are unordered lists of objects. The Go execution engine must iterate through the nodes to find the specific node matching `NodeTypeTrigger...` to act as the head pointer for traversal.
3. **Edges are Relationships:** Don't traverse array indices sequentially. Look for the `ReactFlowEdge` where `edge.Source == currentNode.ID`, then set the `currentNode.ID = edge.Target` to execute the correct graph path.
4. **Asynchronous Pausing:** To handle `Wait` or `Delay` nodes flawlessly without blocking threads:
   - Marshal and save the raw JSON context variables inside a `workflow_executions` table (`state_data` column).
   - Mark the current executing node ID.
   - Stop traversal and return cleanly out of the Go routine.
   - Schedule an asynchronous worker queue job (e.g., Asynq/Redis) to pick up the execution later at `current_node.ID`, using the persisted state data to resume smoothly.
